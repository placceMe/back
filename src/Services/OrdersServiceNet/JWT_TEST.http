### JWT Token Validation Test
### ???????? ????????????? JWT ??????? ??? UsersService ?? OrdersService

@usersServiceUrl = http://localhost:5002
@ordersServiceUrl = http://localhost:5004

### 1. ????????? JWT ????? ? UsersService
POST {{usersServiceUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}

### 2. ????????? ????? ? ????????? ???? ?? ??????? ?????
@authToken = paste_your_jwt_token_here

### 3. ??????????? ?????????? ?????? ? UsersService
GET {{usersServiceUrl}}/api/auth/me
Authorization: Bearer {{authToken}}

### 4. ???????? ????? ? OrdersService
GET {{ordersServiceUrl}}/api/orders/my
Authorization: Bearer {{authToken}}

### 5. ????????? ??????? ??????????
POST {{ordersServiceUrl}}/api/orders
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "userId": "replace-with-user-id-from-jwt",
  "notes": "Test order after JWT sync",
  "deliveryAddress": "Test Address 123",
  "items": [
    {
      "productId": "123e4567-e89b-12d3-a456-426614174001",
      "quantity": 1,
      "price": 99.99
    }
  ]
}

### 6. ??????????? ???????? ???? ??? ???????
GET {{ordersServiceUrl}}/Health

### ===== DEBUGGING =====

### ??????????? JWT ?????? (????????? ????? ?? ????????? ?? https://jwt.io)
### ????????? ??:
### 1. "sub" (ClaimTypes.NameIdentifier) = user ID
### 2. "role" claims ??????? ???? ???????????  
### 3. "iss" = "UsersService"
### 4. "aud" = "MarketplaceClient"
### 5. "exp" ?? ????????????

### ????????? Claims ? JWT:
# {
#   "sub": "user-guid-here",           // ClaimTypes.NameIdentifier  
#   "name": "UserName",                // ClaimTypes.Name
#   "email": "user@example.com",       // ClaimTypes.Email
#   "role": ["User"],                  // ClaimTypes.Role (???? ???? ?????)
#   "jti": "jwt-id",                   // JwtRegisteredClaimNames.Jti
#   "iss": "UsersService",             // Issuer
#   "aud": "MarketplaceClient",        // Audience  
#   "exp": 1234567890                  // Expiration
# }